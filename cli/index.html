<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Saddle Stitch PDF Reordering Tool (US / Left-Open)</title>
  <style>
    :root{
      --bg:#0b0c10;
      --panel:#11131a;
      --text:#e9ecf1;
      --muted:#a9b0bd;
      --line:#2a2f3a;
      --accent:#7aa2ff;
      --good:#35d07f;
      --warn:#ffcc66;
      --bad:#ff6b6b;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      background:linear-gradient(180deg, var(--bg), #07080b 60%);
      color:var(--text);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      border-bottom:1px solid var(--line);
      background:rgba(17,19,26,0.8);
      backdrop-filter: blur(8px);
      position:sticky; top:0; z-index:10;
    }
    .wrap{max-width:980px; margin:0 auto; padding:18px 18px}
    .title{
      display:flex; flex-wrap:wrap; gap:12px; align-items:baseline; justify-content:space-between;
    }
    h1{font-size:20px; margin:0}
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:6px 10px; border:1px solid var(--line); border-radius:999px;
      color:var(--muted); font-size:12px;
    }
    nav{
      display:flex; flex-wrap:wrap; gap:10px;
      margin-top:12px;
    }
    nav a{
      padding:6px 10px; border:1px solid var(--line); border-radius:10px;
      color:var(--muted);
    }
    nav a:hover{color:var(--text); border-color:#3a4250}
    main{padding:22px 0 60px}
    section{
      margin:18px 0;
      padding:18px;
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(17,19,26,0.7);
    }
    h2{margin:0 0 8px; font-size:18px}
    h3{margin:16px 0 8px; font-size:14px; color:var(--muted); font-weight:600; text-transform:uppercase; letter-spacing:.04em}
    p{margin:10px 0}
    ul{margin:10px 0 0 18px}
    code, pre{
      font-family:var(--mono);
      font-size:13px;
    }
    pre{
      margin:12px 0;
      padding:12px 12px;
      border:1px solid var(--line);
      border-radius:12px;
      background:#0a0b10;
      overflow:auto;
      position:relative;
    }
    .kbd{
      font-family:var(--mono);
      font-size:12px;
      padding:2px 6px;
      border:1px solid var(--line);
      border-bottom-color:#1b1f2a;
      border-radius:6px;
      background:#0a0b10;
      color:var(--text);
      white-space:nowrap;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }
    @media (min-width: 860px){
      .grid{grid-template-columns: 1fr 1fr}
    }
    .note{
      border-left:3px solid var(--accent);
      padding:10px 12px;
      background:rgba(122,162,255,0.10);
      border-radius:10px;
      color:var(--text);
    }
    .ok{border-left-color: var(--good); background:rgba(53,208,127,0.10)}
    .warn{border-left-color: var(--warn); background:rgba(255,204,102,0.10)}
    .bad{border-left-color: var(--bad); background:rgba(255,107,107,0.10)}
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
      border:1px solid var(--line);
      border-radius:12px;
      overflow:hidden;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      vertical-align:top;
      color:var(--text);
      font-size:13px;
    }
    th{
      text-align:left;
      color:var(--muted);
      font-weight:600;
      background:#0a0b10;
    }
    tr:last-child td{border-bottom:none}
    .btn{
      appearance:none;
      border:1px solid var(--line);
      background:#0a0b10;
      color:var(--text);
      padding:7px 10px;
      border-radius:10px;
      cursor:pointer;
      font-size:12px;
    }
    .btn:hover{border-color:#3a4250}
    .copy{
      position:absolute;
      top:10px; right:10px;
    }
    footer{
      color:var(--muted);
      border-top:1px solid var(--line);
      padding:18px 0 0;
      margin-top:16px;
      font-size:12px;
    }
    .small{color:var(--muted); font-size:13px}
  </style>
</head>

<body>
  <header>
    <div class="wrap">
      <div class="title">
        <h1>Saddle Stitch PDF Reordering Tool <span class="small">(US / Left-Open)</span></h1>
        <div class="pill">No npm • Static HTML • Open in Browser</div>
      </div>
      <nav>
        <a href="#what">What</a>
        <a href="#requirements">Requirements</a>
        <a href="#files">Files</a>
        <a href="#usage">Usage</a>
        <a href="#print">Print Settings</a>
        <a href="#pitfalls">Pitfalls</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section id="what">
      <h2>1) What This Does</h2>
      <p>
        This tool reorders pages in a PDF for <strong>Saddle Stitch / Booklet printing</strong>,
        optimized for <strong>US/EU left-open binding</strong>:
        <em>first sheet: left = last page, right = first page</em>.
      </p>

      <div class="note ok">
        <strong>Left-open (US/EU) default:</strong> first outer spread becomes <span class="kbd">[last | 1]</span>.
      </div>

      <p class="small">
        Original input PDF (assumed): <span class="kbd">summary.pdf</span>
      </p>

      <h3>Example (8 pages)</h3>
      <pre><button class="btn copy" data-copy="Original order: 1 2 3 4 5 6 7 8&#10;Booklet order: 8, 1, 2, 7, 6, 3, 4, 5">Copy</button>Original order:
1 2 3 4 5 6 7 8

Reordered for Saddle Stitch (left-open / US style):
8, 1, 2, 7, 6, 3, 4, 5
</pre>

      <p>Features:</p>
      <ul>
        <li>Automatically pads with blank pages if page count isn’t a multiple of 4</li>
        <li>Outputs a print-ready booklet PDF</li>
      </ul>
    </section>

    <section id="requirements">
      <h2>2) Requirements</h2>
      <p>Python 3.9+ and the <span class="kbd">pypdf</span> library.</p>

      <pre><button class="btn copy" data-copy="pip install pypdf">Copy</button>pip install pypdf</pre>
    </section>

    <section id="files">
      <h2>3) Files</h2>
      <pre><button class="btn copy" data-copy=".\n├── booklet_reorder.py\n├── summary.pdf\n└── summary_booklet.pdf  (generated)">Copy</button>.
├── booklet_reorder.py
├── summary.pdf                 (input)
└── summary_booklet.pdf         (generated output)
</pre>

      <div class="note warn">
        If your PDF isn’t named <span class="kbd">summary.pdf</span>, change the commands accordingly.
      </div>
    </section>

    <section id="usage">
      <h2>4) Usage</h2>

      <h3>US / Left-Open (Default)</h3>
      <pre><button class="btn copy" data-copy="python booklet_reorder.py summary.pdf summary_booklet.pdf">Copy</button>python booklet_reorder.py summary.pdf summary_booklet.pdf</pre>

      <h3>Optional: Japanese-Style Right-Open</h3>
      <pre><button class="btn copy" data-copy="python booklet_reorder.py summary.pdf summary_booklet_rightopen.pdf --right-open">Copy</button>python booklet_reorder.py summary.pdf summary_booklet_rightopen.pdf --right-open</pre>

      <div class="note">
        Output PDF is meant to be printed as <strong>2 pages per sheet</strong>, <strong>duplex</strong>, <strong>short-edge</strong>.
      </div>
    </section>

    <section id="print">
      <h2>5) Print Settings (IMPORTANT)</h2>

      <div class="grid">
        <div>
          <h3>Print Settings (English)</h3>
          <table>
            <tr><th>Paper Size</th><td>US Letter</td></tr>
            <tr><th>Pages per Sheet</th><td>2</td></tr>
            <tr><th>Orientation</th><td>Landscape</td></tr>
            <tr><th>Duplex Printing</th><td>On</td></tr>
            <tr><th>Binding</th><td><strong>Short Edge</strong> (Flip on Short Edge)</td></tr>
            <tr><th>Scale</th><td>100% (Do <strong>NOT</strong> use “Fit to Page”)</td></tr>
            <tr><th>Page Order</th><td>Default (Do <strong>NOT</strong> reorder)</td></tr>
          </table>

          <p><strong>After printing:</strong> stack sheets → fold in half → staple on the center fold (Saddle Stitch).</p>
        </div>

        <div>
          <h3>印刷設定（日本語）</h3>
          <table>
            <tr><th>用紙サイズ</th><td>US Letter</td></tr>
            <tr><th>1枚あたり</th><td>2ページ</td></tr>
            <tr><th>向き</th><td>横（ランドスケープ）</td></tr>
            <tr><th>両面印刷</th><td>オン</td></tr>
            <tr><th>綴じ方向</th><td><strong>短辺綴じ</strong>（Short Edge）</td></tr>
            <tr><th>拡大／縮小</th><td>100%（「用紙に合わせる」はオフ）</td></tr>
            <tr><th>ページ順</th><td>変更しない</td></tr>
          </table>

          <p><strong>印刷後：</strong>重ねる → 半分に折る → 中央をホチキス留め（中綴じ）</p>
        </div>
      </div>
    </section>

    <section id="pitfalls">
      <h2>6) Notes / Common Pitfalls</h2>

      <div class="note bad">
        <strong>Long-edge binding</strong> often causes pages to print upside down. Use <strong>Short-edge</strong>.
      </div>
      <div class="note warn" style="margin-top:10px">
        Avoid “Fit to Page” — it can shift inner margins (gutter).
      </div>
      <div class="note warn" style="margin-top:10px">
        Don’t manually reorder pages in the printer dialog. Reorder in the PDF.
      </div>

      <h3>Quick Checklist</h3>
      <ul>
        <li><span class="kbd">summary.pdf</span> → run the script → <span class="kbd">summary_booklet.pdf</span></li>
        <li>Print: Letter, 2-up, Duplex, Short-edge, Scale 100%</li>
        <li>Fold + staple</li>
      </ul>

      <footer>
        <p>Tip: If your printer flips the back side unexpectedly, try toggling “Short-edge / Long-edge” in the print dialog, but keep the PDF order unchanged.</p>
      </footer>
    </section>
  </main>

  <script>
    // Simple copy-to-clipboard (no libraries)
    (function () {
      const buttons = document.querySelectorAll("[data-copy]");
      buttons.forEach(btn => {
        btn.addEventListener("click", async () => {
          const text = btn.getAttribute("data-copy") || "";
          try {
            await navigator.clipboard.writeText(text);
            const old = btn.textContent;
            btn.textContent = "Copied!";
            setTimeout(() => (btn.textContent = old), 900);
          } catch (e) {
            // Fallback: create a temp textarea
            const ta = document.createElement("textarea");
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            try { document.execCommand("copy"); } catch {}
            document.body.removeChild(ta);
            const old = btn.textContent;
            btn.textContent = "Copied!";
            setTimeout(() => (btn.textContent = old), 900);
          }
        });
      });
    })();
  </script>
</body>
</html>